[[_TOC_]]
# 基本ルール
- [必須]  
  下記の基本構成から例外的に外れる場合には、チームメンバーと相談すること。
- [非推奨]  
  フォルダおよびファイルの作成時にコピー&ペーストを行うのは望ましくない。
  - ファイル名変更に伴うコードの自動修正により、予期しないバグが混入する  
    リスクがある。
  - 右クリックメニューの「追加」から項目を追加するのが正しい手続きである。
- [必須]   
  論理的なフォルダ構成と物理的なフォルダ構成の整合性を保ち、Windowsの  
  ファイルエクスプローラとVisualStudioのソリューションエクスプローラで  
  フォルダ構成が同じように見えるようにすること。
  - 論理的なフォルダ構成と物理的なフォルダ構成が常に一致していないと、  
    「ソリューション構成」という言葉の意味が曖昧になってしまう恐れが生じる。
  - :warning: 注意 :warning:  
    ソリューションフォルダはソリューション内における論理フォルダであるため、  
    ソリューションフォルダを生成しても実際のフォルダは生成されない。  
- [任意]  
  ソリューション内にプロジェクトが多数ある場合、フォルダを作成して  
  プロジェクトをグループ化してよい。  
  その際にはVisualStudioにて対応するソリューションフォルダも作成すること。

# フォルダ構成

## 目的
- 採用したアーキテクチャに基づいたシステムを構築すること。
- 開発作業を柔軟に分担できるようにすること。
  - システムを意味のある単位にきちんと分解して整理することとほぼ同義。
  - 技術者の保有スキルに応じて適材適所で作業を割り振ることができるようになる。
    - 開発計画時に選択肢を多くもつことができる。
    - 未経験の作業でもある程度内容が限定されるため、学習コストを減らすことができる。
      - 経験の浅い開発者が開発を通して着実にスキルを身に着けることができる。
    - スペシャリストを迎え入れやすい。
  - 具体的には、
    - 機能ごとに開発できるようにしたい。
      - はじめに小さく作って、フィードバックを反映しつつ徐々に機能を追加していくことができる。
    - フロントエンド開発とバックエンド開発を分離したい。
      - 必要なスキルセットが異なるため、それぞれに合った開発者を割り当てたい。
      - 初期の設計段階で打ち合わせと画面モック作成を同時に行いたい。
    - 同時に進む仕様変更と不具合修正作業の衝突を減らしたい。
      - 仮に衝突してもシンプルに解決可能であってほしい。

## 注意
:warning: 以下は **Windows** のエクスプローラ上でのフォルダツリーを表す。  
:warning: [*] のフォルダ(物理)には対応するソリューションフォルダ(論理)が必要となる。

## WEBアプリケーションのフォルダ構成

```
WebApplication
│  (ソリューションのルートフォルダ)
│
│  .gitignore                             [git] 無視ファイル設定
│  WebApplication.sln                     ソリューションファイル
│  README.md                              [Azure] リポジトリの概要説明ファイル
│
├─src [*]
│   │  (ソースコードフォルダ)
│   │
│   WebApplication
│       │  (Webアプリケーションプロジェクトのルートフォルダ)
│       │
│       │  WebApplication.csproj          プロジェクトファイル
│       │  appsettings.Development.json   設定ファイル (開発用)
│       │  appsettings.json               設定ファイル (デフォルト)
│       │  Program.cs                     プログラムのエントリポイント定義用クラス
│       │  Startup.cs                     アプリケーション起動時の設定用クラス
│       │
│       ├─Abstractions
│       │  │  (抽象化定義)
│       │  │
│       │  └─AppLayer
│       │     (インターフェース定義 - アプリケーション層)
│       │
│       ├─AppLayer
│       │  │  (アプリケーション層の実装)
│       │  │
│       │  ├─Filters
│       │  │  (フィルタ)
│       │  │
│       │  :  (随時、アプリケーション層にて必要な要素を追加、フォルダに分類)
│       │
│       ├─Controllers
│       │  (Webアプリケーション用のMVCコントローラ)
│       │
│       ├─Properties
│       │  │  (VisualStudioのためのプロジェクト設定)
│       │  │
│       │  └─PublishProfiles
│       │     (デプロイ設定)
│       │
│       ├─Resources
│       │  (ローカライズ設定)
│       │
│       ├─ViewModels
│       │  │  (UI表示用データ)
│       │  │
│       │  ├─機能別ビューモデルフォルダ
│       │  :
│       │
│       ├─Views
│       │  │  (Razorテンプレート)
│       │  │
│       │  │  _ViewImports.cshtml         テンプレート内で利用するクラスの参照を宣言するファイル
│       │  │  _ViewStart.cshtml           すべてのビューに共通の準備用コードを定義するファイル
│       │  │
│       │  ├─Shared
│       │  │  │  (共通テンプレート)
│       │  │  │
│       │  │  │    Error.cshtml           エラー画面テンプレート
│       │  │  │    _Layout.cshtml         共通レイアウトのテンプレート
│       │  │  │
│       │  │  ├─機能別共通テンプレートフォルダ
│       │  │  :
│       │  │
│       │  ├─機能別Razorテンプレートフォルダ
│       │  :
│       │
│       │  (以下はフロントエンド向けの静的コンテンツ)
│       └─wwwroot
│           ├─css
│           ├─js
│           └─lib
│               ├─font-awesome
│               ├─vue
│               :
│
└─test [*]
    │  (テストコードフォルダ)
    │
    └─Testing
        │  (テストプロジェクトのルートフォルダ)
        │
        │  Testing.csproj                 テストプロジェクトファイル
        │
        ├─IntegrationTest
        │  (統合テストフォルダ)
        │
        └─UnitTest
           (単体テストフォルダ)
```

## WEB API
### 全体

- src フォルダにサービスごとのプロジェクトを作成する。
- サービスのプロジェクトは必ずクライアント自動生成用のプロジェクトを伴う。
- テストはサービスごとにフォルダでまとめる。
  - 各サービスのテストは、本体の実装との対応が分かるようにフォルダに分けること。

```
WebApi
├─src [*]
│   ├─AaaaClient           ┐  ┐
│   │                      ├──│── サービスとクライアント(自動生成) は常に一対
│   ├─AaaaService          ┘  │
│   :                         │
│   :                         ├── サービスごとに分割する
│   ├─ZzzzClient              │
│   │                         │
│   └─ZzzzService             ┘
│
└─test [*]
    └─Testing
        ├─IntegrationTest
        │   ├─AaaaService     ┐ 
        :   :                 ├── サービスごとの統合テスト
        │   └─ZzzzService     ┘ 
        │
        └─UnitTest
            ├─AaaaService     ┐ 
            :                 ├── サービスごとの単体テスト
            └─ZzzzService     ┘ 
```

### 詳細

```
WebApi
│  (ソリューションのルートフォルダ)
│
│  .gitignore                             [git] 無視ファイル設定
│  WebApi.sln                             ソリューションファイル
│  README.md                              [Azure] リポジトリの概要説明ファイル
│
├─src [*]
│   │  (ソースコードフォルダ)
│   │
│   ├─AaaaClient
│   │   │  (自動生成されるWeb APIクライアントプロジェクトのフォルダ)
│   │   │
│   │   │  nswag.json                     Web APIクライアント自動生成の設定
│   │   │  AaaaClient.csproj              プロジェクトファイル
│   │   │  AaaaClientFactory.cs           Web APIクライアント生成用ファクトリ
│   │   │              
│   │   └─NSwag
│   │      (NSwagによる自動生成コード出力フォルダ)
│   │          
│   │          Contracts.cs               [自動生成] Web APIクライアントのインターフェース定義 (入出力データの型、例外も同梱)
│   │          Services.cs                [自動生成] Web APIクライアントの実装
│   │
│   ├─AaaaService
│   │   │  (サービスのプロジェクトのルートフォルダ)
│   │   │
│   │   │  AaaaService.csproj             プロジェクトファイル
│   │   │  appsettings.Development.json   設定ファイル (開発用)
│   │   │  appsettings.json               設定ファイル (デフォルト)
│   │   │  Program.cs                     プログラムのエントリポイント定義用クラス
│   │   │  Startup.cs                     アプリケーション起動時の設定用クラス
│   │   │
│   │   ├─Abstractions
│   │   │  │  (抽象化定義)
│   │   │  │
│   │   │  ├─Domain
│   │   │  │  (インターフェース定義 - ドメイン層)
│   │   │  │
│   │   │  └─Infrastructure
│   │   │     (インターフェース定義 - インフラストラクチャ層)
│   │   │
│   │   ├─Controllers
│   │   │  (Web API用のMVCコントローラ)
│   │   │
│   │   ├─Domain
│   │   │  │  (ドメイン層の実装)
│   │   │  │
│   │   │  ├─Dto
│   │   │  │  (層境界横断のためのデータ定義)
│   │   │  │
│   │   │  ├─Entities
│   │   │  │  (エンティティ)
│   │   │  │
│   │   │  └─Services
│   │   │     │  (ドメインサービス)
│   │   │     │
│   │   │     └─Stubs
│   │   │        (ドメインサービスのスタブ実装)
│   │   │
│   │   ├─Infrastructure
│   │   │  │  (インフラストラクチャ層の実装)
│   │   │  │
│   │   │  └─Repositories
│   │   │     (リポジトリ)
│   │   │
│   │   ├─Models
│   │   │  (リポジトリ向けのPOCOデータ)
│   │   │
│   │   └─Properties
│   │      │  (VisualStudioのためのプロジェクト設定)
│   │      │
│   │      └─PublishProfiles
│   │         (デプロイ設定)
│   │
│   :  (他のサービス)
│
└─test [*]
    │  (テストコードフォルダ)
    │
    └─Testing
        │  (テストプロジェクトのルートフォルダ)
        │
        │  Testing.csproj                 テストプロジェクトファイル
        │
        ├─IntegrationTest
        │  (統合テストフォルダ)
        │
        └─UnitTest
           (単体テストフォルダ)
```